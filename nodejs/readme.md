# BuildJS: Реализация на Node.JS

## builder.js

Модуль с одной внешней функцией `build(fname, context, callback)`. Функция принимает имя файла, флаги сборщика в виде
объекта и callback-функцию, которой по окончании работы передаётся объект ошибки, если она была, и сгенерированный
код. Модуль предназначен для использования в различных build-скриптах.

## build.js

Скрипт командной строки. Принимает имя файла и флаги сборщика. Выводит в stdout результат сборки.

    node build.js script.js -debug -foo -bar > script.pack.js

## server.js

Сервер для локального тестирования. Используется при написании скриптов, чтобы не запускать builder после каждого
изменения. Возвращает результат сборки файла, путь к которому берётся из pathname урла.

Например, в ответ на запрос http://localhost:9595/home/my/dev/script.js соберёт файл /home/my/dev/script.js и
вернёт его в браузер.

Удобно использовать в сочетании с nginx. Пусть, например, ваш проект лежит в папке /home/my/dev, и предполагается,
что сжатые js-файлы будут лежать в папке js, а несжатые в js-debug. Тогда следующие строки в локальном nginx.conf
будут перенаправлять все запросы к js-файлам на сервер-сборщик.

    location /js/ {
        proxy_pass http://127.0.0.1:9595/home/my/dev/js-debug/;
    }

А при выкладке проекта на сервер достаточно будет запустить консольный build.js.

Не забывайте, что при запуске сервера в Windows под cygwin имена дисков преобразуются в cygdrive. Т.е. путь
c:\my\dev будет выглядеть как /cygdrive/c/my/dev.